<html>
  <head>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <title> Hal Demo </title>
  </head>
  <body style="width:70%; margin:auto; padding:0;">
    <script type="text/javascript">
      function xml_http_post(url, data, callback) {
        var req = false;
        try { req = new XMLHttpRequest(); }
        catch (e) {
          try { req = new ActiveXObject("Msxml2.XMLHTTP"); }
          catch (e) { 
            alert("Sorry, your browser isn't supported"); return false; }
        }
        req.open("POST", url, true);
        req.onreadystatechange=function(){if(req.readyState==4){callback(req);}}
        req.send(data);
      }
      function send_req() {
        var demoId = document.getElementById('demo_id');
        var demoResult = document.getElementById('demo_result');
        var name = document.getElementById('name_id').value;
        demoResult.innerHTML += '&lt' + name + '&gt ' + demoId.value + '<br>';
        xml_http_post( "index.html", name + '%%%' + demoId.value, recv_resp);
        demoId.placeholder = "";
        demoId.value = "";
      }
      function LogIn() {
        var demoId = document.getElementById('demo_id');
        demoId.disabled = false;
        var name = document.getElementById('name_id').value;
        xml_http_post(
            "index.html", 
            "UUID of player "+ name + " is DEMO", 
            recv_resp);
      }
      function LogOut(){
        var demoId = document.getElementById('demo_id');
        var name = document.getElementById('name_id').value;
        xml_http_post(
            "index.html", 
            name + " left the game", 
            recv_resp);
        return true;
      }
      function recv_resp(req) {
        var demoId = document.getElementById('demo_id');
        var demoResult = document.getElementById('demo_result');
        var scroller = document.getElementById('div_id');
        var helpMsg = '<i>Hal only responds when you include his name</i><br>';
        if (req.responseText){ demoResult.innerHTML += req.responseText; }
        else { demoResult.innerHTML += helpMsg; }
        scroller.scrollTop = scroller.scrollHeight;
        demoId.focus();
      }
    </script>
    <div 
      style="font-family:'Courier New',Courier,monospace;font-size:16px;">
      <br> <h2> Hal Live Demo </h2>
      <div id="div_id" 
        style="height:40%;border:1px solid black;
               overflow:auto;overflow-x:auto;overflow-y:scroll">
        <span id="demo_result"> 
          <i>Log in and you're ready to go!</i><br>
        </span>
        <br>
      </div>
      <form>
        &lt<input id="name_id" value="Steve" size="5" 
            style="font-family:'Courier New',Courier,monospace;font-size:16px;"
            onkeydown="this.size=(this.value.length >5) ? this.value.length : 5;"/>&gt
        <input 
          id="demo_id" value="" size="40" 
          style="font-family:'Courier New',Courier,monospace;font-size:16px;"
          autofocus placeholder="how are you Hal?"
          onkeydown="if(event.keyCode==13){event.preventDefault();send_req();}"
          disabled
          />

          <input type="button" value="Log out" onclick="LogOut();" 
          style="float:right;font-family:'Courier New',Courier,monospace;font-size:16px;"
          />
          <input type="button" value="Log in" onclick="LogIn();" 
          style="float: right;font-family:'Courier New',Courier,monospace;font-size:16px;"
          />
      </form>
    </div>
  </body>
</html>
